<html>
<head>
<title>Clutch</title>
<link rel="stylesheet" type="text/css" href="static/css/clutch.css" />
<script type="text/javascript" src="static/jquery.js"></script>
<script type="text/javascript" src="static/jquery-ui.js"></script>
<script type="text/javascript" src="static/jquery.eventsource.js"></script>
<script type="text/javascript" src="static/d3.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        activeNumBoxes = []
        function startstream(){$.eventsource({
            label: "nums",
            url: "/sse-stream/",
            dataType: "json",
            message: function(msg){
                activeNumBoxes.each(function(i){
                    varname = $(this).data('var');
                    if( varname in msg ){
                        $(this).children(".Data").html(msg[varname]);
                    }
                });
            }
        });}
        
        function setupNumBoxes(){
            boxes = $(".NumBox");
            boxes.html("<div class='Data'></div><div class='Label'></div>");
            boxes.each(function(i){
                $(this).data('var',$(this).attr("id"))
                $(this).children(".Label")
                    .html($(this).data("var"))
                    .css("font-size",$(this).children(".Label").height()*0.90);
                $(this).children(".Data")
                    .css( "font-size",$(this).children(".Data").height()*0.80);
                if( $(this).parent().attr('id') == 'Active' ){
                    activeNumBoxes.push($(this))
                }
            });            
        }
        setupNumBoxes();
        activeNumBoxes = $(".NumBox");
        startstream();


    });

</script>
</head>
<body>
    <div id="Available">
        <div class="NumBox" data-var="Time"></div>
    </div>
    <div id="Active">
        <div class="NumBox" data-var="TWA"></div>
        <div class="NumBox" data-var="TWS"></div>
    </div>
</body>
</html>